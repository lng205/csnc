# CS-FEC 实验报告

## 循环移位 + XOR MDS 纠删码算法研究

---

## 1. 研究背景

前向纠错码（Forward Error Correction, FEC）在数据存储和网络传输中具有重要应用。传统的 Reed-Solomon 码虽然具有良好的纠错能力，但其基于有限域乘法的实现复杂度较高，不利于硬件实现。

本研究提出的 **CS-FEC（Cyclic Shift FEC）** 算法，通过将有限域运算转换为**循环移位 + XOR** 操作，大幅降低了计算复杂度，实现了硬件友好的 MDS 纠删码。

---

## 2. 算法原理

### 2.1 系统模型

CS-FEC 是一种 **(M, K) 系统性 MDS 码**：
- **M**: 原始数据符号数
- **K**: 编码后总符号数 (M 个数据 + K-M 个校验)
- **L**: 循环矩阵维度，符号位宽为 L-1 bits

### 2.2 核心创新

**传统方法**: 使用 GF(2^n) 有限域乘法
```
Parity = Σ (α^i × data_i)  // GF乘法复杂
```

**CS-FEC 方法**: 使用循环移位 + XOR
```
Parity = XOR(cyclic_shift(data_i, shift_i))  // 硬件友好
```

### 2.3 数学基础

范德蒙德矩阵 V 在 GF(2^k) 上的元素可以映射为循环移位操作：

$$\alpha^i \rightarrow C^i$$

其中 $C$ 是 L×L 的循环移位基矩阵，$C^i$ 表示循环右移 i 位。

---

## 3. 实验设计

### 实验 1: 算法正确性验证
验证不同 (M, K, L) 配置下编解码的一致性。

### 实验 2: 编码矩阵结构可视化
展示范德蒙德矩阵到循环移位矩阵的转换过程。

### 实验 3: 计算复杂度对比
对比 CS-FEC 与传统 Reed-Solomon 的位操作数。

### 实验 4: 硬件资源估算
估算 FPGA 实现的 LUT/FF 资源占用。

### 实验 5: 丢失模式恢复测试
测试不同丢失数量下的恢复成功率。

### 实验 6: 编码效率分析
分析编码率与容错能力的权衡关系。

---

## 4. 实验结果

### 4.1 算法正确性验证

| 配置 (M,K) | 数据符号 | 校验符号 | 符号位宽 | 成功率 |
|------------|----------|----------|----------|--------|
| (2,3)      | 2        | 1        | 4 bits   | 100%   |
| (3,5)      | 3        | 2        | 4 bits   | 100%   |
| (6,10)     | 6        | 4        | 10 bits  | 100%   |

**结论**: 在有效配置下，CS-FEC 算法编解码完全正确。

### 4.2 计算复杂度对比

| 配置 | 传统 RS 操作数 | CS-FEC 操作数 | 复杂度降低 |
|------|---------------|---------------|------------|
| (2,3,5) | 36 | 4 | **88.9%** |
| (3,5,5) | 112 | 16 | **85.7%** |
| (4,6,7) | 324 | 36 | **88.9%** |
| (4,8,9) | 1120 | 96 | **91.4%** |
| (6,10,11) | 2600 | 200 | **92.3%** |
| (8,12,13) | 4944 | 336 | **93.2%** |

**关键发现**: 
- CS-FEC 相比传统 RS 可降低 **85-93%** 的计算复杂度
- 随着编码规模增大，优势更加明显

### 4.3 硬件资源估算

| 配置 | 符号位宽 | CS-FEC LUT | 传统 RS LUT | LUT 节省 |
|------|----------|------------|-------------|----------|
| (2,3) | 4 | 12 | 10 | -20% |
| (3,5) | 4 | 28 | 32 | **12.5%** |
| (4,6) | 6 | 60 | 90 | **33.3%** |
| (4,8) | 8 | 128 | 304 | **57.9%** |
| (6,10) | 10 | 260 | 700 | **62.9%** |

**分析**:
- 小规模配置下优势不明显
- 大规模配置可节省 **50-60%** 的 LUT 资源
- 循环移位在硬件中仅为布线，不消耗逻辑资源

### 4.4 编码效率分析

| 配置 | 编码率 | 冗余度 | 最大可恢复丢失 |
|------|--------|--------|----------------|
| (2,3) | 66.7% | 50% | 1 |
| (3,5) | 60.0% | 66.7% | 2 |
| (4,6) | 66.7% | 50% | 2 |
| (4,8) | 50.0% | 100% | 4 |
| (8,10) | 80.0% | 25% | 2 |
| (8,12) | 66.7% | 50% | 4 |

**权衡分析**: 编码率与容错能力呈反向关系，可根据应用场景选择合适配置。

---

## 5. 图表

### 图 1: 编码矩阵转换过程
展示了从 GF(2^4) 范德蒙德矩阵到 GF(2) 循环移位矩阵的转换。
- 左: 原始范德蒙德矩阵 (2×3)
- 中: 循环移位基矩阵 C₅ (5×5)
- 右: 转换后的编码矩阵 (10×10)

📄 文件: `results/fig1_matrix_transform.png`

### 图 2: 辅助矩阵结构
- 左: 零填充矩阵 $Z_p$ - 用于升维
- 右: 一填充矩阵 $O_p$ - 用于降维

📄 文件: `results/fig2_helper_matrices.png`

### 图 3: 计算复杂度对比
- 左: 位操作数对比（对数坐标）
- 右: 复杂度降低百分比

📄 文件: `results/fig3_complexity_comparison.png`

### 图 4: FPGA 资源对比
- 左: LUT 使用量对比
- 右: 编解码器资源分布

📄 文件: `results/fig4_hardware_resources.png`

### 图 5: 丢失恢复能力
展示 (4,8) 配置在不同丢失数量下的恢复成功率。

📄 文件: `results/fig5_erasure_recovery.png`

### 图 6: 编码效率分析
- 左: 不同配置的编码率
- 右: 编码率与容错能力的权衡（散点图）

📄 文件: `results/fig6_encoding_efficiency.png`

---

## 6. RTL 仿真验证

使用 Vivado 2025.1 进行 RTL 仿真验证：

```
========================================
        CS-FEC Codec Testbench
========================================

======== (2,3) Configuration ========
[2,3] Test 1: No erasure         PASS
[2,3] Test 2: D0 erased          PASS ✓ 成功恢复
[2,3] Test 3: D1 erased          PASS ✓ 成功恢复
[2,3] Test 4: Parity erased      PASS
[2,3] Test 5: Edge case          PASS
[2,3] Test 6: Two erasures       PASS ✓ 正确检测失败

======== (3,5) Configuration ========
[3,5] Test 7-10: All passed      PASS

Summary: 10/10 tests passed
========================================
```

---

## 7. 结论

### 7.1 主要贡献

1. **计算复杂度降低**: CS-FEC 相比传统 RS 码降低 85-93% 的位操作
2. **硬件友好**: 循环移位在 FPGA 中仅为布线，不消耗逻辑资源
3. **灵活配置**: 支持多种 (M, K) 配置，适应不同应用场景
4. **完整实现**: 提供 Python 算法验证和 SystemVerilog RTL 实现

### 7.2 适用场景

- **分布式存储**: RAID 系统纠删码
- **网络编码**: 数据包丢失恢复
- **通信系统**: 无线信道纠错
- **数据中心**: 大规模数据冗余存储

### 7.3 未来工作

1. 支持更多丢失的解码器实现
2. 流水线优化提高吞吐量
3. 与现有存储系统集成测试

---

## 8. 参考文献

[1] Reed, I. S., & Solomon, G. (1960). Polynomial codes over certain finite fields. *Journal of the Society for Industrial and Applied Mathematics*.

[2] Plank, J. S. (2013). Erasure codes for storage systems. *USENIX Annual Technical Conference*.

[3] 本项目相关论文（待发表）

---

## 附录: LaTeX 表格

完整的 LaTeX 格式表格见 `results/tables.tex`，可直接导入论文使用。

---

*实验完成时间: 2025年11月*
*实验环境: Windows 10, Python 3.12, Vivado 2025.1*

