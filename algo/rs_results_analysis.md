# RS 与循环移位 FEC 的结果分析（拍数/资源）

本文从“码字帧化”和“符号位宽”两个维度，解释本仓库现有仿真所得的拍数结果，并给出获取资源占用的方法与建议。

## 帧化与拍数模型
- 参数映射：`K=3, N=5, m=10`（10 位/符号），每包 1500 Byte。
- 符号数：`S = ceil(1500*8/m) = 1200`；码字数：`C = ceil(S/K) = 400`（每码字 3 个信息符号）。
- 理想流水：若输入与输出完全重叠（AXIS 满速、无空转），每码字需输出 `N` 个符号（其中 `K` 为直通，`N-K` 为校验尾），故每包拍数≈`N*C=5*400=2000`；3 包≈`6000` 拍。
- 严格串行 TB（现有 `rs_encoder_bench_cycles.tcl`）：先推 `K` 个输入后完全等待 `N` 个输出，不与下一码字重叠，近似每码字 `K+N=8` 拍；3×400≈`9600` 拍，加上起停/间隙，实测≈`10800` 拍。

结论：10800 拍是串行驱动的上界；工程化流水化应逼近 6000 拍（再加少量管线延迟）。

## “每次从3包各取10bit”的对应关系
- 这等价于以 `m=10` 的 RS 符号为“跨 3 个输入流的同一位切片”构成一个码字的 `K=3` 个信息符号；对每个切片生成 `N-K=2` 个校验符号，形成 5 路输出流。
- 每包 1500B 对应 1200 个切片（符号），因此共有 `C=400` 个码字，串行逐码字处理即得到上节的拍数。


## 资源占用与时序
- 获取方法：运行 `scripts/rs_synth_util_report.tcl`，对目标器件（如 ZU3EG）综合 RS 编码器与解码器，导出 `utilization.csv` 与 `timing_summary.rpt`。
- 规律：
  - 编码器资源 < 解码器资源；`m` 越大、`t=(N-K)/2` 越大，乘法器/查找表/寄存器规模越高。
  - 我方“循环移位+XOR”编码器在相同吞吐下 LUT 更低；但配套矩阵解码若以位级线性代数实现，需评估移位+XOR 的叠加次数与流水深度。

## 后续建议
- 端到端仿真：已将 `rs_encode_decode_erase_tb.tcl` 的仿真时间延长至 20 ms，运行后收集 `ede_detail.csv`，统计成功率与 `cw_cycles` 的均值/P95/最大值。
- 综合评估：对 `xc7z010clg225-1` 与 `xczu3eg-sbva484-1-e` 各跑一次综合，记录 LUT/FF/BRAM、Fmax，并放入 `verilog/rs_bench_report.md` 的资源章节。
- 工程化优化：重写 bench 以输入/输出并行，消除码字间空隙，用以评估近似上限吞吐所需拍数。
